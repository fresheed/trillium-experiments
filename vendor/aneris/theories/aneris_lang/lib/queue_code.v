(* This file is automatically generated from the OCaml source file
<repository_root>/ml_sources/aneris_lang/lib/queue_code.ml *)

From aneris.aneris_lang Require Import ast.
From aneris.aneris_lang.lib Require Import list_code.

Definition queue_empty : val := λ: <>, ([], []).

Definition queue_is_empty : val :=
  λ: "q",
  match: Fst "q" with
    SOME "_p" => #false
  | NONE => match: Snd "q" with
        SOME "_p" => #false
      | NONE => #true
      end
  end.

Definition queue_add : val := λ: "e" "q", (Fst "q", "e" :: Snd "q").

Definition queue_norm : val :=
  λ: "q",
  match: Fst "q" with
    SOME "_p" => "q"
  | NONE => (list_rev (Snd "q"), [])
  end.

Definition queue_peek_opt : val :=
  λ: "q",
  let: "q'" := queue_norm "q" in
  match: Fst "q'" with
    SOME "p" => SOME (Fst "p")
  | NONE => NONE
  end.

Definition queue_take_opt : val :=
  λ: "q",
  let: "q'" := queue_norm "q" in
  match: Fst "q'" with
    SOME "p" => SOME ((Fst "p"), ((Snd "p"), (Snd "q'")))
  | NONE => NONE
  end.
